import { ReactNode } from 'react'
import dayjs from 'dayjs'
import MessageCommonItemBtn from '@/features/message/components/common/MessageCommonItemBtn'
import { MessageListItem } from '@mtobdvlb/shared-types'
import { useMessageDelete } from '@/features'
import { toast } from '@/lib'

const MessageCommonItemMetaData = ({
  children,
  item,
}: {
  children?: ReactNode
  item: MessageListItem
}) => {
  const { deleteMessage } = useMessageDelete()

  return (
    <div className={'mt-2.5 flex items-center text-xs text-text3'}>
      <div className={'mr-[15px]'}>{dayjs(item.createdAt).format('YYYY年M月DD日 HH:mm')}</div>

      {children}
      <MessageCommonItemBtn
        className={
          'hover:text-brand_blue opacity-0 pointer-events-none group-hover:opacity-100 group-hover:pointer-events-auto'
        }
        onClick={async (e) => {
          e.stopPropagation()
          const { code } = await deleteMessage(item.id)
          if (code) return
          toast('已删除')
        }}
      >
        <svg
          xmlns='http://www.w3.org/2000/svg'
          viewBox='0 0 16 16'
          width='16'
          height='16'
          className={'size-4'}
        >
          <path
            d='M5 3.25C5 2.3295266666666663 5.746193333333332 1.5833333333333333 6.666666666666666 1.5833333333333333L9.333333333333332 1.5833333333333333C10.253799999999998 1.5833333333333333 11 2.3295266666666663 11 3.25L11 3.833333333333333C11 4.109473333333333 10.776133333333334 4.333333333333333 10.5 4.333333333333333C10.223866666666666 4.333333333333333 10 4.109473333333333 10 3.833333333333333L10 3.25C10 2.8818133333333336 9.701533333333334 2.583333333333333 9.333333333333332 2.583333333333333L6.666666666666666 2.583333333333333C6.298473333333334 2.583333333333333 6 2.8818133333333336 6 3.25L6 3.833333333333333C6 4.109473333333333 5.77614 4.333333333333333 5.5 4.333333333333333C5.22386 4.333333333333333 5 4.109473333333333 5 3.833333333333333L5 3.25z'
            fill='currentColor'
          ></path>
          <path
            d='M1.3333333333333333 4.166666666666666C1.3333333333333333 3.8905266666666667 1.5571933333333332 3.6666666666666665 1.8333333333333333 3.6666666666666665L14.166666666666666 3.6666666666666665C14.4428 3.6666666666666665 14.666666666666666 3.8905266666666667 14.666666666666666 4.166666666666666C14.666666666666666 4.442806666666666 14.4428 4.666666666666666 14.166666666666666 4.666666666666666L1.8333333333333333 4.666666666666666C1.5571933333333332 4.666666666666666 1.3333333333333333 4.442806666666666 1.3333333333333333 4.166666666666666z'
            fill='currentColor'
          ></path>
          <path
            d='M3.1666666666666665 5.75C3.4428066666666663 5.75 3.6666666666666665 5.973859999999999 3.6666666666666665 6.25L3.6666666666666665 11.603066666666665C3.6666666666666665 12.442166666666667 4.28456 13.130766666666666 5.094706666666666 13.1985C5.950586666666666 13.270033333333332 6.993366666666667 13.333333333333332 8 13.333333333333332C9.006633333333333 13.333333333333332 10.049399999999999 13.270033333333332 10.905299999999999 13.1985C11.715433333333332 13.130766666666666 12.333333333333332 12.442166666666667 12.333333333333332 11.603066666666665L12.333333333333332 6.25C12.333333333333332 5.973859999999999 12.557199999999998 5.75 12.833333333333332 5.75C13.109466666666666 5.75 13.333333333333332 5.973859999999999 13.333333333333332 6.25L13.333333333333332 11.603066666666665C13.333333333333332 12.9358 12.342766666666666 14.081833333333332 10.9886 14.195C10.1174 14.267833333333332 9.044566666666666 14.333333333333332 8 14.333333333333332C6.955433333333333 14.333333333333332 5.882626666666667 14.267833333333332 5.011406666666666 14.195C3.6572266666666664 14.081833333333332 2.6666666666666665 12.9358 2.6666666666666665 11.603066666666665L2.6666666666666665 6.25C2.6666666666666665 5.973859999999999 2.8905266666666667 5.75 3.1666666666666665 5.75z'
            fill='currentColor'
          ></path>
          <path
            d='M6.333333333333333 7C6.60948 7 6.833333333333333 7.223866666666667 6.833333333333333 7.5L6.833333333333333 9.833333333333332C6.833333333333333 10.109466666666666 6.60948 10.333333333333332 6.333333333333333 10.333333333333332C6.057193333333332 10.333333333333332 5.833333333333333 10.109466666666666 5.833333333333333 9.833333333333332L5.833333333333333 7.5C5.833333333333333 7.223866666666667 6.057193333333332 7 6.333333333333333 7z'
            fill='currentColor'
          ></path>
          <path
            d='M9.666666666666666 7C9.942799999999998 7 10.166666666666666 7.223866666666667 10.166666666666666 7.5L10.166666666666666 9.833333333333332C10.166666666666666 10.109466666666666 9.942799999999998 10.333333333333332 9.666666666666666 10.333333333333332C9.390533333333334 10.333333333333332 9.166666666666666 10.109466666666666 9.166666666666666 9.833333333333332L9.166666666666666 7.5C9.166666666666666 7.223866666666667 9.390533333333334 7 9.666666666666666 7z'
            fill='currentColor'
          ></path>
        </svg>
        <span>删除该通知</span>
      </MessageCommonItemBtn>
    </div>
  )
}

export default MessageCommonItemMetaData
